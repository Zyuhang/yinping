"use strict";!function(p){var n,o,i=p(".quan"),e=p(".jian"),t=p(".jia01");p.cookie("cookiesid")&&p.cookie("cookienum")&&(n=p.cookie("cookiesid").split(","),o=p.cookie("cookienum").split(","),p.each(n,function(i,e){var t,a;t=n[i],a=o[i],p.ajax({url:"http://localhost/JS-2002/yinping_project/php/taobaodata.php"}).done(function(i){var e=JSON.parse(i);p.each(e,function(i,e){var n;t==e.sid&&((n=p(".repeat:hidden").clone(!0,!0)).find(".img10").find("img").attr("src",e.url),n.find(".img10").find("img").attr("sid",e.sid),n.find(".title").find("span").html(e.title),n.find(".three").find(".qian").html(e.price),n.find(".jia").find("input").val(a),n.find(".select").find("input").prop("checked",!0),n.find(".three").find(".span01").html((e.price*a).toFixed(2)),n.css("display","block"),p("#repeat01").append(n),h())})})}));var a=[],c=[];function s(){c=p.cookie("cookiesid")&&p.cookie("cookienum")?(a=p.cookie("cookiesid").split(","),p.cookie("cookienum").split(",")):(a=[],[])}function r(i){s();var e=i.parents(".repeat").find(".img10").find("img").attr("sid");c[p.inArray(e,a)]=i.parents(".repeat").find(".input").val(),p.cookie("cookienum",c,{expires:10,path:"/"})}i.on("change",function(){p(".repeat:visible").find(".select input").prop("checked",i.prop("checked")),i.prop("checked",p(this).prop("checked")),h()});var d=p(".repeat:visible").find(".select input");function f(i){return(parseFloat(i.parents(".repeat").find(".three .qian").html())*parseInt(i.parents(".repeat").find(".input").val())).toFixed(2)}function h(){var n=0,t=0;p(".repeat:visible").each(function(i,e){p(e).find(".select input").prop("checked")&&(n+=parseInt(p(e).find(".input").val()),t+=parseInt(p(e).find(".span01").html()))}),p(".jiesuan").find(".span20").html(n),p(".jiesuan").find(".span30").html(t.toFixed(2))}function l(n,i){var t=-1;p.each(i,function(i,e){n===e&&(t=i)}),i.splice(t,1),c.splice(t,1),p.cookie("cookiesid",i,{expires:10,path:"/"}),p.cookie("cookienum",c,{expires:10,path:"/"})}p(".repeat").on("change",d,function(){p(".repeat:visible").find(".select input").length===p(".repeat:visible").find("input:checked").length?i.prop("checked",!0):i.prop("checked",!1),h()}),t.on("click",function(){var i=p(this).parent().find(".input").val();++i<=1&&(i=1),p(this).parent().find(".input").val(i),p(this).parents(".repeat").find(".span01").html(f(p(this))),h(),r(p(this))}),e.on("click",function(){var i=p(this).parent().find(".input").val();--i<=1&&(i=1),p(this).parent().find(".input").val(i),p(this).parents(".repeat").find(".span01").html(f(p(this))),h(),r(p(this))}),p(".jia .input").on("input",function(){var i=p(this).val();/^\d+$/g.test(i)||p(this).val(1),p(this).val()<=0&&p(this).val(1),p(this).parents(".repeat").find(".span01").html(f(p(this))),h(),r(p(this))}),p(".repeat").find(".three").find("a").on("click",function(){s(),window.confirm("你确定要删除吗？")&&(p(this).parents(".repeat").remove(),l(p(this).parents(".repeat").find(".img10").find("img").attr("sid"),a)),h()}),p(".jiesuan").find("a").on("click",function(){s(),window.confirm("你确定要删除吗？")&&(p(".repeat:visible").each(function(){p(this).find(".select input").prop("checked")&&(p(this).remove(),l(p(this).find(".img10").find("img").attr("sid"),a))}),h())})}(jQuery);